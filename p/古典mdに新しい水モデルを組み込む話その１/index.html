<!doctype html><html lang=ja dir=ltr><head><meta charset=utf-8><meta name=viewport content='width=device-width,initial-scale=1'><meta name=description content="重水ってそんなに珍しいの？"><title>古典MDに新しい水モデルを組み込む話（その１）</title>
<link rel=canonical href=https://yfsanzui.github.io/p/%E5%8F%A4%E5%85%B8md%E3%81%AB%E6%96%B0%E3%81%97%E3%81%84%E6%B0%B4%E3%83%A2%E3%83%87%E3%83%AB%E3%82%92%E7%B5%84%E3%81%BF%E8%BE%BC%E3%82%80%E8%A9%B1%E3%81%9D%E3%81%AE%EF%BC%91/><link rel=stylesheet href=/scss/style.min.e128e1c7ae8efb5a3cecafada741b70a9430965f50dddb19825f2a491762d537.css><meta property='og:title' content="古典MDに新しい水モデルを組み込む話（その１）"><meta property='og:description' content="重水ってそんなに珍しいの？"><meta property='og:url' content='https://yfsanzui.github.io/p/%E5%8F%A4%E5%85%B8md%E3%81%AB%E6%96%B0%E3%81%97%E3%81%84%E6%B0%B4%E3%83%A2%E3%83%87%E3%83%AB%E3%82%92%E7%B5%84%E3%81%BF%E8%BE%BC%E3%82%80%E8%A9%B1%E3%81%9D%E3%81%AE%EF%BC%91/'><meta property='og:site_name' content='YFsanzui Website'><meta property='og:type' content='article'><meta property='article:section' content='Post'><meta property='article:tag' content='MD Simulation'><meta property='article:tag' content='環境構築'><meta property='article:tag' content='General'><meta property='article:published_time' content='2024-05-04T00:00:00+00:00'><meta property='article:modified_time' content='2024-05-04T00:00:00+00:00'><meta property='og:image' content='https://yfsanzui.github.io/p/%E5%8F%A4%E5%85%B8md%E3%81%AB%E6%96%B0%E3%81%97%E3%81%84%E6%B0%B4%E3%83%A2%E3%83%87%E3%83%AB%E3%82%92%E7%B5%84%E3%81%BF%E8%BE%BC%E3%82%80%E8%A9%B1%E3%81%9D%E3%81%AE%EF%BC%91/Chrysanthemum_Chinese-forget-me-not.jpg'><meta name=twitter:title content="古典MDに新しい水モデルを組み込む話（その１）"><meta name=twitter:description content="重水ってそんなに珍しいの？"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content='https://yfsanzui.github.io/p/%E5%8F%A4%E5%85%B8md%E3%81%AB%E6%96%B0%E3%81%97%E3%81%84%E6%B0%B4%E3%83%A2%E3%83%87%E3%83%AB%E3%82%92%E7%B5%84%E3%81%BF%E8%BE%BC%E3%82%80%E8%A9%B1%E3%81%9D%E3%81%AE%EF%BC%91/Chrysanthemum_Chinese-forget-me-not.jpg'></head><body class=article-page><script>(function(){const e="StackColorScheme";localStorage.getItem(e)||localStorage.setItem(e,"auto")})()</script><script>(function(){const t="StackColorScheme",e=localStorage.getItem(t),n=window.matchMedia("(prefers-color-scheme: dark)").matches===!0;e=="dark"||e==="auto"&&n?document.documentElement.dataset.scheme="dark":document.documentElement.dataset.scheme="light"})()</script><div class="container main-container flex on-phone--column extended"><aside class="sidebar left-sidebar sticky compact"><button class="hamburger hamburger--spin" type=button id=toggle-menu aria-label=メニューを開く・閉じる>
<span class=hamburger-box><span class=hamburger-inner></span></span></button><header><figure class=site-avatar><a href=/><img src=/img/avatar_hu25de3a7164165f45dff1163c589b8313_20117_300x0_resize_q75_box.jpg width=300 height=300 class=site-logo loading=lazy alt=Avatar>
</a><span class=emoji>🤞</span></figure><div class=site-meta><h1 class=site-name><a href=/>YFsanzui Website</a></h1><h2 class=site-description>技術と気分の備忘録</h2></div></header><ol class=social-menu><li><a href=https://github.com/YFsanzui/yfsanzui.github.io target=_blank title=GitHub rel=me><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-brand-github" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M9 19c-4.3 1.4-4.3-2.5-6-3m12 5v-3.5c0-1 .1-1.4-.5-2 2.8-.3 5.5-1.4 5.5-6a4.6 4.6.0 00-1.3-3.2 4.2 4.2.0 00-.1-3.2s-1.1-.3-3.5 1.3a12.3 12.3.0 00-6.2.0C6.5 2.8 5.4 3.1 5.4 3.1a4.2 4.2.0 00-.1 3.2A4.6 4.6.0 004 9.5c0 4.6 2.7 5.7 5.5 6-.6.6-.6 1.2-.5 2V21"/></svg></a></li></ol><ol class=menu id=main-menu><li><a href=/><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-home" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><polyline points="5 12 3 12 12 3 21 12 19 12"/><path d="M5 12v7a2 2 0 002 2h10a2 2 0 002-2v-7"/><path d="M9 21v-6a2 2 0 012-2h2a2 2 0 012 2v6"/></svg>
<span>Home</span></a></li><li><a href=/about/><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-user" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="7" r="4"/><path d="M6 21v-2a4 4 0 014-4h4a4 4 0 014 4v2"/></svg>
<span>About</span></a></li><li><a href=/archives/><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-archive" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><rect x="3" y="4" width="18" height="4" rx="2"/><path d="M5 8v10a2 2 0 002 2h10a2 2 0 002-2V8"/><line x1="10" y1="12" x2="14" y2="12"/></svg>
<span>Archives</span></a></li><li><a href=/search/><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-search" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="10" cy="10" r="7"/><line x1="21" y1="21" x2="15" y2="15"/></svg>
<span>Search</span></a></li><li><a href=/links/><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-link" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><path d="M10 14a3.5 3.5.0 005 0l4-4a3.5 3.5.0 00-5-5l-.5.5"/><path d="M14 10a3.5 3.5.0 00-5 0l-4 4a3.5 3.5.0 005 5l.5-.5"/></svg>
<span>Links</span></a></li><li class=menu-bottom-section><ol class=menu><li id=i18n-switch><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-language" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M4 5h7"/><path d="M9 3v2c0 4.418-2.239 8-5 8"/><path d="M5 9c-.003 2.144 2.952 3.908 6.7 4"/><path d="M12 20l4-9 4 9"/><path d="M19.1 18h-6.2"/></svg>
<select name=language title=language onchange="window.location.href=this.selectedOptions[0].value"><option value=https://yfsanzui.github.io/ selected>日本語</option><option value=https://yfsanzui.github.io/en/>English</option></select></li><li id=dark-mode-toggle><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-toggle-left" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="8" cy="12" r="2"/><rect x="2" y="6" width="20" height="12" rx="6"/></svg>
<svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-toggle-right" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="16" cy="12" r="2"/><rect x="2" y="6" width="20" height="12" rx="6"/></svg>
<span>ダークモード</span></li></ol></li></ol></aside><aside class="sidebar right-sidebar sticky"><section class="widget archives"><div class=widget-icon><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-hash" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><line x1="5" y1="9" x2="19" y2="9"/><line x1="5" y1="15" x2="19" y2="15"/><line x1="11" y1="4" x2="7" y2="20"/><line x1="17" y1="4" x2="13" y2="20"/></svg></div><h2 class="widget-title section-title">目次</h2><div class=widget--toc><nav id=TableOfContents><ol><li><a href=#重水>重水</a></li><li><a href=#古典ｍｄで重水を表現する難しさ>古典ＭＤで重水を表現する難しさ</a><ol><li><a href=#単なる重い水ではない>単なる「重」い「水」ではない</a></li><li><a href=#実装のハードルが高い>実装のハードルが高い</a></li></ol></li><li><a href=#重水を使えるようにするための戦略>重水を使えるようにするための戦略</a><ol><li><a href=#amberの外で系を構成した後amber形式にファイル変換する>Amberの外で系を構成した後、Amber形式にファイル変換する</a></li><li><a href=#ambertoolsをいじる>AmberToolsをいじる</a></li></ol></li><li><a href=#自分がやったこと>自分がやったこと</a></li></ol></nav></div></section></aside><main class="main full-width"><article class="has-image main-article"><header class=article-header><div class=article-image><a href=/p/%E5%8F%A4%E5%85%B8md%E3%81%AB%E6%96%B0%E3%81%97%E3%81%84%E6%B0%B4%E3%83%A2%E3%83%87%E3%83%AB%E3%82%92%E7%B5%84%E3%81%BF%E8%BE%BC%E3%82%80%E8%A9%B1%E3%81%9D%E3%81%AE%EF%BC%91/><img src=/p/%E5%8F%A4%E5%85%B8md%E3%81%AB%E6%96%B0%E3%81%97%E3%81%84%E6%B0%B4%E3%83%A2%E3%83%87%E3%83%AB%E3%82%92%E7%B5%84%E3%81%BF%E8%BE%BC%E3%82%80%E8%A9%B1%E3%81%9D%E3%81%AE%EF%BC%91/Chrysanthemum_Chinese-forget-me-not_huf622ad5149fcf79a80022bb5424637ac_2120062_800x0_resize_q75_box.jpg srcset="/p/%E5%8F%A4%E5%85%B8md%E3%81%AB%E6%96%B0%E3%81%97%E3%81%84%E6%B0%B4%E3%83%A2%E3%83%87%E3%83%AB%E3%82%92%E7%B5%84%E3%81%BF%E8%BE%BC%E3%82%80%E8%A9%B1%E3%81%9D%E3%81%AE%EF%BC%91/Chrysanthemum_Chinese-forget-me-not_huf622ad5149fcf79a80022bb5424637ac_2120062_800x0_resize_q75_box.jpg 800w, /p/%E5%8F%A4%E5%85%B8md%E3%81%AB%E6%96%B0%E3%81%97%E3%81%84%E6%B0%B4%E3%83%A2%E3%83%87%E3%83%AB%E3%82%92%E7%B5%84%E3%81%BF%E8%BE%BC%E3%82%80%E8%A9%B1%E3%81%9D%E3%81%AE%EF%BC%91/Chrysanthemum_Chinese-forget-me-not_huf622ad5149fcf79a80022bb5424637ac_2120062_1600x0_resize_q75_box.jpg 1600w" width=800 height=450 loading=lazy alt="Featured image of post 古典MDに新しい水モデルを組み込む話（その１）"></a></div><div class=article-details><header class=article-category><a href=/categories/md-simulation/>MD Simulation
</a><a href=/categories/%E7%92%B0%E5%A2%83%E6%A7%8B%E7%AF%89/>環境構築
</a><a href=/categories/general/>General</a></header><div class=article-title-wrapper><h2 class=article-title><a href=/p/%E5%8F%A4%E5%85%B8md%E3%81%AB%E6%96%B0%E3%81%97%E3%81%84%E6%B0%B4%E3%83%A2%E3%83%87%E3%83%AB%E3%82%92%E7%B5%84%E3%81%BF%E8%BE%BC%E3%82%80%E8%A9%B1%E3%81%9D%E3%81%AE%EF%BC%91/>古典MDに新しい水モデルを組み込む話（その１）</a></h2><h3 class=article-subtitle>重水ってそんなに珍しいの？</h3></div><footer class=article-time><div><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-calendar-time" width="56" height="56" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><path d="M11.795 21H5a2 2 0 01-2-2V7a2 2 0 012-2h12a2 2 0 012 2v4"/><circle cx="18" cy="18" r="4"/><path d="M15 3v4"/><path d="M7 3v4"/><path d="M3 11h16"/><path d="M18 16.496V18l1 1"/></svg>
<time class=article-time--published>May 04, 2024</time></div><div><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-clock" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="12" r="9"/><polyline points="12 7 12 12 15 15"/></svg>
<time class=article-time--reading>読了時間: 7分</time></div></footer></div></header><section class=article-content><h1 id=5月>5月</h1><p>お久しぶりです。気づけば５月になってしまいました。外の世界はゴールデンウイークらしいですね。</p><p>ここ最近は投稿できていませんでしたが、ちょっと今日区切りいい所に来たので、この辺で息抜きに文章を書きたいと思います。</p><p>最近は研究のことで頭がいっぱいなのですが、息抜きメニューの中で名探偵コナンブームが再燃しています。かなりご無沙汰していたのですが、久々に見てみるか～となったところ、コナン映画ってこんなに面白いのかと驚きました。</p><p>まず事件のトリックももちろん凄いのですが、その事件の規模感が自分の心を掴みますね。ビルが崩壊したり、人工衛星が落ちて来たり、リニアが暴走したり、世界がどうかしてしまいそうな５分間の行く末が、あの少年の一蹴りに委ねられる、あの瞬間に興奮し、主人公たちを心から応援したくなる感じです。</p><p>これ分かってくれる人少ないかもしれないですが、自分はオープニングのアレンジがいつも聞き入ってしまいます。色々聞き比べた上で甲乙つけ難いのですが、個人的には「ゼロの執行人」のパターンが一番好きです。</p><p>あとコナンって恋愛色が強かったことを今更理解しました。。鈍感な少年だった自分は気づきもしなかったのですが、二人はいつも想い合っていて、それが世紀の大事件を解決する原動力になっているようです。これはコナン映画の伝統なので、寧ろそういうテーマがある話だってことに気付けるくらいには自分も成長できたのかな（これくらいで成長なんて言わんよな、、）、と思いました。</p><p>写真ですが、大きく黄色い花が「クリサンセマム・ムルチコーレ」、小さく青い花が「シノワスレナグサ」らしいです。仲良く並んでいるのがきれいだと思って撮りました。
花言葉はそれぞれ「誠実」、「真実の愛」ということで、誠実な主人公とヒロインが、本当の姿で真実の愛にたどり着けますようにということ（どういうこと）で、本題に入りましょう。</p><h1 id=重水シミュレーション>重水シミュレーション</h1><p>とあることがきっかけで、研究の中で重水ータンパク質系を構成し、<strong>Amber</strong>で古典分子動力学シミュレーションを行うことになりました。</p><h2 id=重水>重水</h2><p>普通の水は水素２つと酸素１つが共有結合して出来上がる分子で構成されています。水素の原子核は基本的に陽子１個でできていますが、これに中性子を１個加えると、同位体である「<strong>重水素</strong>」になります。もう一個中性子を加えると「三重水素」またの名を「<strong>トリチウム</strong>」になります。原発の問題で話題になったやつですね。ざっくり言うと、<strong>重水</strong>は普通の水素の代わりに重水素を含んだ水のことになります。</p><h2 id=古典ｍｄで重水を表現する難しさ>古典ＭＤで重水を表現する難しさ</h2><p>さて、なんやかんやで重水をモデル化し、タンパク質をその中に沈めたシミュレーション系を構築したいのですが、これが簡単ではありません。色々理由があります。</p><h3 id=単なる重い水ではない>単なる「重」い「水」ではない</h3><p>水素の質量が中性子がくっついただけ大きくなる（質量欠損もあるでしょうが）ので、水分子モデルの質量を純増すれば重水になりそうですが、そういうわけではないそうです。</p><p>重水には通常の水（軽水）と異なる物性が報告されているようで、例えば<strong>水素結合強度</strong>が変わって来たり、その結果、軽水・重水の質量密度比は、それらの分子量比に単純比例しないらしいです。詳しいことはまだ勉強中なのですが、こういった事情から、正確には<strong>分極・電荷情報</strong>や、<strong>van del Waals相互作用項</strong>も修正が入り、そういう修正モデルがここ20数年研究・開発されています。</p><h3 id=実装のハードルが高い>実装のハードルが高い</h3><p>開発されてるんだね、じゃあそれ使えばええやん、となりたいのですが、色々な分子動力学シミュレーションパッケージプログラム、特に自分の使っているAmberでは、重水モデルが見当たらないんですね。もっと探せばあるのかもしれないのですが、Amberにないということは、研究途中ということもあって、あまり普及していないのかなあと思います。</p><p>自分の研究の場合、現時点ではAmberから逃れられないので、どうにかしてAmber上に重水（今回はD2Oに限ります）を作らないといけません。そのためには、<strong>重水の力場パラメータをどうにかしてAmberのシステムに組み込む必要があります</strong>。通常の利用範囲ではAmberのソースファイルに手を付けたりはしないので、非常にハードルを感じますね。</p><p><img src=/p/%E5%8F%A4%E5%85%B8md%E3%81%AB%E6%96%B0%E3%81%97%E3%81%84%E6%B0%B4%E3%83%A2%E3%83%87%E3%83%AB%E3%82%92%E7%B5%84%E3%81%BF%E8%BE%BC%E3%82%80%E8%A9%B1%E3%81%9D%E3%81%AE%EF%BC%91/H2OvsD2O.png width=3667 height=1189 srcset="/p/%E5%8F%A4%E5%85%B8md%E3%81%AB%E6%96%B0%E3%81%97%E3%81%84%E6%B0%B4%E3%83%A2%E3%83%87%E3%83%AB%E3%82%92%E7%B5%84%E3%81%BF%E8%BE%BC%E3%82%80%E8%A9%B1%E3%81%9D%E3%81%AE%EF%BC%91/H2OvsD2O_hu5fb8d9959dc72119575bca1f102b67c4_134237_480x0_resize_box_3.png 480w, /p/%E5%8F%A4%E5%85%B8md%E3%81%AB%E6%96%B0%E3%81%97%E3%81%84%E6%B0%B4%E3%83%A2%E3%83%87%E3%83%AB%E3%82%92%E7%B5%84%E3%81%BF%E8%BE%BC%E3%82%80%E8%A9%B1%E3%81%9D%E3%81%AE%EF%BC%91/H2OvsD2O_hu5fb8d9959dc72119575bca1f102b67c4_134237_1024x0_resize_box_3.png 1024w" loading=lazy alt=H2OとD2Oは物理としてもMDとしても興味深い class=gallery-image data-flex-grow=308 data-flex-basis=740px></p><h2 id=重水を使えるようにするための戦略>重水を使えるようにするための戦略</h2><p>そのままでは重水モデルをAmberで使えないので、ソースファイルレベルで何かしらの操作を行って、重水モデルを導入する必要があります。そのための方針として色々考えてみたところ、大まかに２つあるのではないかと思いました。</p><h3 id=amberの外で系を構成した後amber形式にファイル変換する>Amberの外で系を構成した後、Amber形式にファイル変換する</h3><p>もしAmberの外に、カスタマイズした力場パラメータで系を構成する手立てがあるのであれば、そこで系を組み立てるのがやりやすいでしょう。ＭＤはパッケージによってファイル形式やコマンドの流儀が異なるのですが、これは<strong>ParmEd</strong>などでファイル形式変換をすることによって克服できる可能性があります。ここがうまくいけば外で作った系をAmber形式に直せて、無事Amberに重水を持ってくることができるでしょう。</p><ul><li><p>メリット</p><ul><li><strong>Gromacs</strong>はカスタマイズした力場パラメータセットを取り込みやすい構造をしているため、わりと検索するとそのやりかたが見つかります。このように実績や先例が多いのであればそれに従うのが賢明です。</li></ul></li><li><p>デメリット</p><ul><li>ただ、逆にGromacsには <strong>Amber特有の力場パラメータ（ff19SBなど）</strong> が入っていないので、これをインポートするのが面倒かもしれません。</li><li>変換プログラムがどこまで正確に翻訳してくれているのかが不安要素として残ります。 <strong>複数のプログラムが絡めば絡むほど、このミスマッチ問題は肥大していく</strong> ので、この点では好ましいとは言えないでしょう。</li></ul></li></ul><h3 id=ambertoolsをいじる>AmberToolsをいじる</h3><p>普段AmberToolsの <strong>tLeaP</strong> を使って系を作成することが多いので、AmberTools自体が重水系を作る機能を持っていればそれで解決します。ただ先ほども述べた通り、Amberには重水のモデルが標準実装されていないので、tLeaPのソースファイルがもつディレクトリ構造に準拠して、適宜ファイル追加、編集をすることになります。</p><ul><li><p>メリット</p><ul><li>AmberToolsに従った記述をおこなえれば、ParmEdやGromacsに頼る必要がなくなり、翻訳や流儀の差異によって生じるデータの齟齬のリスクがなくなります。</li><li>ff19SBなどAmber特有の力場との組み合わせが容易になります。</li></ul></li><li><p>デメリット</p><ul><li>Gromacs以上に、AmberToolsの書き換えを行っている事例はヒットしにくいです。このため類似の事例が豊富ではなく、困ったときに当たるべき資料が少ないです。</li><li>AmberToolsはGromacsに比べてファイルを書き換えたり追加したりする箇所が多そうです。電荷情報とvan del Waals相互作用項を同じファイルで定義できないなど、規定する情報が比較的分散しており、どこまでファイル依存関係が広がっているのかが一見分かりにくいです。</li></ul></li></ul><h2 id=自分がやったこと>自分がやったこと</h2><p>２つの方法を実際に自分で試してみて、やりやすさに関しては一つ目の方だったのですが、途中でうまくいかなくなり、結局二つ目の方法に落ち着きました。最初はどのファイルがどう噛み合って動いているのか良く分からなかったのですが、良く見れば数個のファイルを書き換えたりすれば最低限使えそうな形には持っていけている様子でした。まあAmberToolsも人間が作っているので、モデルを追加するためだけにそんな何十個にも書き換えないといけない構造になっているはずがないんですがね。</p><p>この後は実際にやった試みについて、ざっくりと紹介できたらと思います（どこまで正しくできているかは保証できませんが…）。今回はここまでです。</p></section><footer class=article-footer><section class=article-tags><a href=/tags/md-simulation/>MD Simulation</a>
<a href=/tags/%E7%92%B0%E5%A2%83%E6%A7%8B%E7%AF%89/>環境構築</a>
<a href=/tags/general/>General</a></section></footer><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.css integrity=sha384-n8MVd4RsNIU0tAv4ct0nTaAbDJwPJzDEaqSD1odI+WdtXRGWt2kTvGFasHpSy3SV crossorigin=anonymous><script src=https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.js integrity=sha384-XjKyOOlGwcjNTAIQHIpgOno0Hl1YQqzUOEleOLALmuqehneUG+vnGctmUb0ZY0l8 crossorigin=anonymous defer></script><script src=https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/contrib/auto-render.min.js integrity=sha384-+VBxd3r6XgURycqtZ117nYw44OOcIax56Z4dCRWbxyPt0Koah1uHoK0o4+/RRE05 crossorigin=anonymous defer></script><script>window.addEventListener("DOMContentLoaded",()=>{renderMathInElement(document.querySelector(`.article-content`),{delimiters:[{left:"$$",right:"$$",display:!0},{left:"$",right:"$",display:!1},{left:"\\(",right:"\\)",display:!1},{left:"\\[",right:"\\]",display:!0}],ignoredClasses:["gist"]})})</script></article><aside class=related-content--wrapper><h2 class=section-title>関連するコンテンツ</h2><div class=related-content><div class="flex article-list--tile"><article class=has-image><a href=/p/display/><div class=article-image><img src=/p/display/dogwood.626cfcb120f691b4c1d765d43ba55b5e_hua4672678718d4077d5a43ff70fc604cd_610993_250x150_fill_q75_box_smart1.jpg width=250 height=150 loading=lazy alt="Featured image of post Matplotlibが動かない" data-key=display data-hash="md5-Ymz8sSD2kbTB12XUO6VbXg=="></div><div class=article-details><h2 class=article-title>Matplotlibが動かない</h2></div></a></article></div></div></aside><footer class=site-footer><section class=copyright>&copy;
2024 YFsanzui</section><section class=powerby>Built with <a href=https://gohugo.io/ target=_blank rel=noopener>Hugo</a><br>テーマ <b><a href=https://github.com/CaiJimmy/hugo-theme-stack target=_blank rel=noopener data-version=3.24.2>Stack</a></b> は <a href=https://jimmycai.com target=_blank rel=noopener>Jimmy</a> によって設計されています。</section></footer><div class=pswp tabindex=-1 role=dialog aria-hidden=true><div class=pswp__bg></div><div class=pswp__scroll-wrap><div class=pswp__container><div class=pswp__item></div><div class=pswp__item></div><div class=pswp__item></div></div><div class="pswp__ui pswp__ui--hidden"><div class=pswp__top-bar><div class=pswp__counter></div><button class="pswp__button pswp__button--close" title="Close (Esc)"></button>
<button class="pswp__button pswp__button--share" title=Share></button>
<button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>
<button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button><div class=pswp__preloader><div class=pswp__preloader__icn><div class=pswp__preloader__cut><div class=pswp__preloader__donut></div></div></div></div></div><div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap"><div class=pswp__share-tooltip></div></div><button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
</button>
<button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)"></button><div class=pswp__caption><div class=pswp__caption__center></div></div></div></div></div><script src=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.js integrity="sha256-ePwmChbbvXbsO02lbM3HoHbSHTHFAeChekF1xKJdleo=" crossorigin=anonymous defer></script><script src=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe-ui-default.min.js integrity="sha256-UKkzOn/w1mBxRmLLGrSeyB4e1xbrp4xylgAWb3M42pU=" crossorigin=anonymous defer></script><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/default-skin/default-skin.min.css crossorigin=anonymous><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.css crossorigin=anonymous></main></div><script src=https://cdn.jsdelivr.net/npm/node-vibrant@3.1.6/dist/vibrant.min.js integrity="sha256-awcR2jno4kI5X0zL8ex0vi2z+KMkF24hUW8WePSA9HM=" crossorigin=anonymous></script><script type=text/javascript src=/ts/main.js defer></script><script>(function(){const e=document.createElement("link");e.href="https://fonts.googleapis.com/css2?family=Lato:wght@300;400;700&display=swap",e.type="text/css",e.rel="stylesheet",document.head.appendChild(e)})()</script></body></html>